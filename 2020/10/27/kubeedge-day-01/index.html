<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>kubeedgeä»‹ç» | Happy Hack Everday</title><meta name="keywords" content="kubeedge,è¾¹ç¼˜è®¡ç®—"><meta name="author" content="Holder"><meta name="copyright" content="Holder"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="KubeEdgeå³KubeåŠ Edgeï¼Œé¡¾åæ€ä¹‰å°±æ˜¯ä¾æ‰˜k8sçš„å®¹å™¨ç¼–æ’èƒ½åŠ›å’Œè°ƒåº¦èƒ½åŠ›ï¼Œå®ç°äº‘è¾¹ååŒã€è®¡ç®—ä¸‹æ²‰ã€æµ·é‡è®¾å¤‡çš„å¹³æ»‘æ¥å…¥ï¼Œ æ—¨åœ¨ä¸ºè¾¹ç¼˜è®¡ç®—å’ŒIoTè¿™ä¸¤å¤§ç‰©è”ç½‘é¢†åŸŸæä¾›ç»Ÿä¸€çš„å¹³å°æ–¹æ¡ˆï¼Œæœ¬æ¬¡åˆ†äº«å°†ç»™å¤§å®¶ç®€å•ä»‹ç»ç›®å‰KubeEdgeé¡¹ç›®è¿›å±•ï¼Œå®ƒçš„æ¶æ„è®¾è®¡ï¼Œä»¥åŠæˆ‘ä»¬åŸºäºKubeEdgeåšäº†å“ªäº›å·¥ä½œï¼Œ å¹¶è¯¦ç»†åˆ†æKubeEdgeæ˜¯å¦‚ä½•è§£å†³äº‘è¾¹ç½‘ç»œé€šä¿¡é—®é¢˜çš„ã€‚  æœ¬æ–‡ä¸»è¦å†…å®¹å–è‡ªä¸€æ¬¡æˆ‘åœ¨å…¬å¸çš„å†…éƒ¨åˆ†äº«"><meta property="og:type" content="article"><meta property="og:title" content="kubeedgeä»‹ç»"><meta property="og:url" content="https://blog.happyhack.io/2020/10/27/kubeedge-day-01/index.html"><meta property="og:site_name" content="Happy Hack Everday"><meta property="og:description" content="KubeEdgeå³KubeåŠ Edgeï¼Œé¡¾åæ€ä¹‰å°±æ˜¯ä¾æ‰˜k8sçš„å®¹å™¨ç¼–æ’èƒ½åŠ›å’Œè°ƒåº¦èƒ½åŠ›ï¼Œå®ç°äº‘è¾¹ååŒã€è®¡ç®—ä¸‹æ²‰ã€æµ·é‡è®¾å¤‡çš„å¹³æ»‘æ¥å…¥ï¼Œ æ—¨åœ¨ä¸ºè¾¹ç¼˜è®¡ç®—å’ŒIoTè¿™ä¸¤å¤§ç‰©è”ç½‘é¢†åŸŸæä¾›ç»Ÿä¸€çš„å¹³å°æ–¹æ¡ˆï¼Œæœ¬æ¬¡åˆ†äº«å°†ç»™å¤§å®¶ç®€å•ä»‹ç»ç›®å‰KubeEdgeé¡¹ç›®è¿›å±•ï¼Œå®ƒçš„æ¶æ„è®¾è®¡ï¼Œä»¥åŠæˆ‘ä»¬åŸºäºKubeEdgeåšäº†å“ªäº›å·¥ä½œï¼Œ å¹¶è¯¦ç»†åˆ†æKubeEdgeæ˜¯å¦‚ä½•è§£å†³äº‘è¾¹ç½‘ç»œé€šä¿¡é—®é¢˜çš„ã€‚  æœ¬æ–‡ä¸»è¦å†…å®¹å–è‡ªä¸€æ¬¡æˆ‘åœ¨å…¬å¸çš„å†…éƒ¨åˆ†äº«"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/donggangcj/CDN@master/image/kubeedge-day-01/2020-10-27-17-52-03.png"><meta property="article:published_time" content="2020-10-27T10:52:34.000Z"><meta property="article:modified_time" content="2024-06-20T02:29:28.127Z"><meta property="article:author" content="Holder"><meta property="article:tag" content="kubeedge"><meta property="article:tag" content="è¾¹ç¼˜è®¡ç®—"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/donggangcj/CDN@master/image/kubeedge-day-01/2020-10-27-17-52-03.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/faicon.png"><link rel="canonical" href="https://blog.happyhack.io/2020/10/27/kubeedge-day-01/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@500&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.4.2',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  ClickShowText: {"text":"å¯Œå¼·,æ°‘ä¸»,æ–‡æ˜,å’Œè«§,è‡ªç”±,å¹³ç­‰,å…¬æ­£,æ³•æ²»,æ„›åœ‹,æ•¬æ¥­,èª ä¿¡,å‹å–„","fontSize":"15px"},
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!1,isSidebar:!0,postUpdate:"2024-06-20 08:29:28"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(function () {
  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }

  const autoChangeMode = '1'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }
})()</script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Happy Hack Everday" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/logo.webp" type="image/webp"><img class="avatar-img" data-lazy-src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/logo.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></picture></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">30</div></a></div></div><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">36</div></a></div></div><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length_num">6</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i> <span>èµ„æº</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i> <span>éŸ³ä¹</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>ç”µå½±</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#KubeEdge%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">KubeEdgeé¡¹ç›®ä»‹ç»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Ekubernetes%E6%9E%84%E5%BB%BA%E8%BE%B9%E7%BC%98%E8%AE%A1%E7%AE%97%E7%9A%84%E4%BC%98%E7%82%B9%E5%92%8C%E7%97%9B%E7%82%B9"><span class="toc-number">2.</span> <span class="toc-text">åŸºäºkubernetesæ„å»ºè¾¹ç¼˜è®¡ç®—çš„ä¼˜ç‚¹å’Œç—›ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KubeEdge%E7%9A%84%E6%9E%B6%E6%9E%84%E5%8F%8A%E6%A0%B8%E5%BF%83%E7%90%86%E5%BF%B5"><span class="toc-number">3.</span> <span class="toc-text">KubeEdgeçš„æ¶æ„åŠæ ¸å¿ƒç†å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%B2%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD"><span class="toc-number">3.1.</span> <span class="toc-text">å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KubeEdge2-0-Roadmap"><span class="toc-number">4.</span> <span class="toc-text">KubeEdge2.0 Roadmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KubeEdge%E7%9A%84%E4%B8%8D%E8%B6%B3%E4%BB%A5%E5%8F%8A%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E5%8E%BB%E5%81%9A%E7%9A%84%E5%B7%A5%E4%BD%9C"><span class="toc-number">5.</span> <span class="toc-text">KubeEdgeçš„ä¸è¶³ä»¥åŠæˆ‘ä»¬éœ€è¦å»åšçš„å·¥ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%89%8D%E6%88%91%E4%BB%AC%E5%81%9A%E7%9A%84"><span class="toc-number">6.</span> <span class="toc-text">ç›®å‰æˆ‘ä»¬åšçš„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kubeedge%E9%80%9A%E4%BF%A1%E5%8E%9F%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">kubeedgeé€šä¿¡åŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%B2%E8%AE%B2%E8%B7%B3%E8%BF%87%E7%9A%84%E5%9D%91"><span class="toc-number">8.</span> <span class="toc-text">è®²è®²è·³è¿‡çš„å‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">9.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">10.</span> <span class="toc-text">å‚è€ƒèµ„æ–™</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image:url(https://cdn.jsdelivr.net/gh/donggangcj/CDN@master/image/kubeedge-day-01/2020-10-27-17-52-03.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Happy Hack Everday</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i> <span>èµ„æº</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i> <span>éŸ³ä¹</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>ç”µå½±</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">kubeedgeä»‹ç»</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2020-10-27T10:52:34.000Z" title="å‘è¡¨äº 2020-10-27 16:52:34">2020-10-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-06-20T02:29:28.127Z" title="æ›´æ–°äº 2024-06-20 08:29:28">2024-06-20</time></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p><strong>KubeEdge</strong>å³<strong>Kube</strong>åŠ <strong>Edge</strong>ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯ä¾æ‰˜k8sçš„å®¹å™¨ç¼–æ’èƒ½åŠ›å’Œè°ƒåº¦èƒ½åŠ›ï¼Œå®ç°äº‘è¾¹ååŒã€è®¡ç®—ä¸‹æ²‰ã€æµ·é‡è®¾å¤‡çš„å¹³æ»‘æ¥å…¥ï¼Œ æ—¨åœ¨ä¸ºè¾¹ç¼˜è®¡ç®—å’ŒIoTè¿™ä¸¤å¤§ç‰©è”ç½‘é¢†åŸŸæä¾›ç»Ÿä¸€çš„å¹³å°æ–¹æ¡ˆï¼Œæœ¬æ¬¡åˆ†äº«å°†ç»™å¤§å®¶ç®€å•ä»‹ç»ç›®å‰KubeEdgeé¡¹ç›®è¿›å±•ï¼Œå®ƒçš„æ¶æ„è®¾è®¡ï¼Œä»¥åŠæˆ‘ä»¬åŸºäºKubeEdgeåšäº†å“ªäº›å·¥ä½œï¼Œ å¹¶è¯¦ç»†åˆ†æKubeEdgeæ˜¯å¦‚ä½•è§£å†³äº‘è¾¹ç½‘ç»œé€šä¿¡é—®é¢˜çš„ã€‚</p><blockquote><p>æœ¬æ–‡ä¸»è¦å†…å®¹å–è‡ªä¸€æ¬¡æˆ‘åœ¨å…¬å¸çš„å†…éƒ¨åˆ†äº«</p></blockquote><h2 id="KubeEdgeé¡¹ç›®ä»‹ç»"><a href="#KubeEdgeé¡¹ç›®ä»‹ç»" class="headerlink" title="KubeEdgeé¡¹ç›®ä»‹ç»"></a>KubeEdgeé¡¹ç›®ä»‹ç»</h2><p>KubeEdgeæ˜¯åä¸ºæ¨å‡ºçš„ä¸šå†…é¦–ä¸ªå¼€æºè¾¹ç¼˜å®¹å™¨å¹³å°é¡¹ç›®ï¼Œæ˜¯ç”±åä¸ºäº‘è¾¹ç¼˜è®¡ç®—äº§å“IEFå¼€æºè€Œæ¥ï¼Œ<strong>Apache 2.0</strong>å¼€æºåè®®ï¼Œå¹¶äº2019å¹´3æœˆæçŒ®ç»™CNCFåŸºé‡‘ä¼šï¼Œåœ¨2019å¹´9æœˆæ™‹çº§ä¸º<strong>å­µåŒ–çº§</strong>é¡¹ç›®ï¼Œ åœ¨CNCFçš„ç¤¾åŒºå»ºè®¾ä¸Šï¼ŒKubeEdgeç§¯æå‚ä¸<strong>kubernetes IoT Edge WG</strong>ï¼ŒåŒæ—¶ä¹Ÿæˆç«‹äº†Device/IoTä¸MECä¸¤ä¸ªSIGï¼Œå¯ä»¥è¯´KubeEdgeå…ˆå‘åˆ¶äººï¼Œ åœ¨ç¤¾åŒºå·²ç»æ‹¥æœ‰äº†è¶³å¤Ÿå¤šè¯è¯­æƒã€‚ç›®å‰å‚ä¸ç¤¾åŒºè´¡çŒ®çš„ä¼ä¸šåŒ…æ‹¬ï¼šä¸­å›½è”é€šï¼ŒARMï¼Œä¸­å›½ç§»åŠ¨ï¼Œè°äº‘ï¼Œä¸­å›½ç”µä¿¡ï¼Œæ—¶é€Ÿäº‘ï¼ŒJD.comï¼Œæµ™å¤§SELå®éªŒå®¤ï¼ŒEMQï¼Œ InfoBloxï¼ŒInovexï¼ŒMidokuraç­‰ã€‚</p><h2 id="åŸºäºkubernetesæ„å»ºè¾¹ç¼˜è®¡ç®—çš„ä¼˜ç‚¹å’Œç—›ç‚¹"><a href="#åŸºäºkubernetesæ„å»ºè¾¹ç¼˜è®¡ç®—çš„ä¼˜ç‚¹å’Œç—›ç‚¹" class="headerlink" title="åŸºäºkubernetesæ„å»ºè¾¹ç¼˜è®¡ç®—çš„ä¼˜ç‚¹å’Œç—›ç‚¹"></a>åŸºäºkubernetesæ„å»ºè¾¹ç¼˜è®¡ç®—çš„ä¼˜ç‚¹å’Œç—›ç‚¹</h2><p>ä¸ºä»€ä¹ˆè¦åŸºäºkubernetesæ„å»ºè¾¹ç¼˜è®¡ç®—å¹³å°å‘¢ï¼Ÿå› ä¸ºkubernetesæ˜¯åœ¨å¤ªé¦™äº†ğŸ¤ªï¼Œé‚£æˆ‘ç®€å•æ¦‚æ‹¬äº†kubernetesä¸»è¦çš„å››æ ¸å¿ƒçš„ä¼˜åŠ¿ï¼š</p><p><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-23-42.webp" type="image/webp"><img src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-23-42.png" alt></picture></p><p><em>å®¹å™¨åŒ–åº”ç”¨å°è£…:</em> ç°å·²æˆä¸ºåº”ç”¨äº¤ä»˜çš„ä¸€ä¸ªè¶‹åŠ¿,æˆ‘ä»¬å¯ä»¥æŠŠåº”ç”¨æ‰“åŒ…åˆ°å®¹å™¨ä¸­ï¼Œä¸”åªéœ€è¦åªæ‰“åŒ…ä¸€æ¬¡ï¼Œ å¯ä»¥è·‘åœ¨å„ç§åœ°æ–¹ï¼Œå¦‚æœåº”ç”¨åˆ°IoTé¢†åŸŸï¼Œæœ‰å¾ˆå¤šä¼ ç»ŸIoTåµŒå…¥å¼è®¾å¤‡ï¼Œå®ƒå…¶å®å¾ˆå¤šç¡¬ä»¶å’Œè½¯ä»¶æ˜¯å¼ºç›¸å…³çš„ï¼Œ æ›´æ¢ä¸€ä¸ªç¡¬ä»¶ï¼Œå¯èƒ½è½¯ä»¶ï¼ˆå›ºä»¶ï¼‰éƒ½éœ€è¦æ›´æ”¹ï¼Œå¦‚æœä½¿ç”¨å®¹å™¨åŒ–å°è£…åï¼Œè®¾å¤‡å¯ä»¥æ”¯æŒå®¹å™¨runtimeï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å®¹å™¨è·‘åœ¨ä»»ä½•IoTè®¾å¤‡ä¸Šã€‚</p><p><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-26-27.webp" type="image/webp"><img src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-26-27.png" alt></picture> <em>é€šç”¨åº”ç”¨æŠ½è±¡å®šä¹‰</em> kubernetesçš„APIåŒ…æ‹¬podçš„å®šä¹‰ä»¥åŠdevelopmentï¼Œdaemonsetç­‰æ§åˆ¶å™¨çš„å®šä¹‰ç°åœ¨å…¶å®åœ¨ä¸šå†…å·²ç»å½¢æˆä¸€å¥—æ ‡å‡†ï¼Œ å¤§å®¶éƒ½æ¯”è¾ƒäº†è§£å’Œè®¤å¯ï¼ŒåŸºäºè¿™äº›é€šç”¨åº”ç”¨è´Ÿè½½æ¨¡å‹åšè¾¹ç¼˜è®¡ç®—å¹³å°ï¼Œå¤§å®¶ä¹Ÿæ›´èƒ½æ¥å—ã€‚</p><p><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-26-52.webp" type="image/webp"><img src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-26-52.png" alt></picture> <em>æ¾è€¦åˆæ¶æ„</em> kubernetessçš„æ¶æ„è®¾è®¡å…·æœ‰ç›¸å½“çš„å…ˆè¿›æ€§ï¼Œå¯æ‹“å±•æ€§æ¯”è¾ƒå¥½ï¼Œæ¯”å¦‚æˆ‘ä»¬åŸºäºk8sä¹‹ä¸Šå¯ä»¥é€šè¿‡CRDæ¥å®šä¹‰ä¸€äº›APIï¼Œé€šè¿‡è®¾å¤‡ç®¡ç†CRDæ¥å®šä¹‰ä¸€äº›IoTé‡Œçš„deviceçš„API, æˆ‘ä»¬å³å¯ä»¥é€šè¿‡k8sçš„ä¸€äº›ç®¡ç†æ–¹å¼ç®¡ç†è¿™äº›è®¾å¤‡ï¼›è¿˜æœ‰ä¸€äº›æœ‰æ„ä¹‰çš„å¯æ‹“å±•ç‚¹ï¼Œæ¯”å¦‚è¾¹ç¼˜èŠ‚ç‚¹å¯ä»¥å¯¹æ¥å„ç§runtimeï¼Œæœ‰äº›è¾¹ç¼˜èŠ‚ç‚¹å®ƒçš„èµ„æºéå¸¸æœ‰é™ï¼Œ æˆ‘ä»¬å°±å¯ä»¥å¯¹æ¥ä¸€äº›è½»é‡åŒ–çš„runtimeã€‚</p><p><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-27-34.webp" type="image/webp"><img src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-27-34.png" alt></picture> <em>ä¸°å¯Œçš„ç¤¾åŒºç”Ÿæ€</em> k8så…¶ä¸°å¯Œçš„æ‹“å±•æ€§ç»™æˆ‘ä»¬å¸¦æ¥æ— é™å¯èƒ½ï¼ŒåŒæ—¶å€ŸåŠ©å…¶ç”Ÿæ€ï¼Œèƒ½å¤Ÿæå¤§åœ°èµ‹èƒ½è¾¹ç¼˜è®¡ç®—å¹³å°ï¼Œå‡å°‘å¼€å‘å·¥ä½œé‡çš„åŒæ—¶ä¹Ÿæœ‰å¼ºå¤§çš„ç¤¾åŒºä¿éšœã€‚</p><p>ä¸‹å›¾æ˜¯KubeEdgeç»™å‡ºçš„å…¶æ ¸å¿ƒçš„ä¼˜åŠ¿ï¼Œä¸éš¾çœ‹å‡ºï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯ç”±äºå…¶å€ŸåŠ©äº†kubernetesæ„å»ºå¹³å°æ‰€å¸¦æ¥çš„ã€‚</p><p><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-30-36.webp" type="image/webp"><img src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-30-36.png" alt></picture></p><p>å½“ç„¶åŸºäºkubernetesè¿˜æœ‰å¾ˆå¤šä¼˜åŠ¿ï¼Œé‚£ä¹ˆæœ‰å“ªäº›è¾¹ç¼˜è®¡ç®—çš„å¸¸è§çš„å…³é”®ç—›ç‚¹éœ€è¦KubeEdgeè§£å†³å‘¢?</p><ol><li>èµ„æºæœ‰é™ï¼šå¸¸è§çš„ç½‘å…³è®¾å¤‡å†…å­˜å¾ˆå°‘ï¼Œæ— æ³•æ»¡è¶³kuberneteså¯¹è¾¹ç¼˜èŠ‚ç‚¹çš„èµ„æºéœ€æ±‚</li><li>ç½‘ç»œä¸ç•…<ul><li>è¾¹ç¼˜ä½äºç§æœ‰ç½‘ç»œï¼Œæ— å…¬ç½‘IP</li><li>äº‘è¾¹è·¨è¶Šå…¬ç½‘ï¼Œå¸¦å®½æœ‰é™ï¼Œå»¶æ—¶é«˜</li><li>k8sçš„List-watchéœ€è¦æ•°æ®ä¸­å¿ƒç½‘ç»œ</li></ul></li><li>è¾¹ç¼˜èŠ‚ç‚¹å¦‚ä½•è‡ªæ²»<ul><li>ç½‘ç»œä¸ç¨³ï¼Œéšæ—¶å¯èƒ½ç¦»çº¿</li><li>è¾¹ç¼˜ä¸šåŠ¡ç¦»çº¿å·¥ä½œ</li><li>è¾¹ç¼˜ç¦»çº¿å¯æ•…éšœæ¢å¤</li></ul></li><li>è®¾å¤‡æ¥å…¥å’Œç®¡ç†<ul><li>ç¼ºå°‘è¾¹ç¼˜è®¾å¤‡æŠ½è±¡</li><li>ç¼ºå°‘è¾¹ç¼˜è®¾å¤‡æ¥å…¥åè®®çš„æ”¯æŒ</li></ul></li></ol><h2 id="KubeEdgeçš„æ¶æ„åŠæ ¸å¿ƒç†å¿µ"><a href="#KubeEdgeçš„æ¶æ„åŠæ ¸å¿ƒç†å¿µ" class="headerlink" title="KubeEdgeçš„æ¶æ„åŠæ ¸å¿ƒç†å¿µ"></a>KubeEdgeçš„æ¶æ„åŠæ ¸å¿ƒç†å¿µ</h2><p>KubeEdgeæ¶æ„ä¸»è¦æ˜¯åˆ†äº†äº‘ã€è¾¹ã€ç«¯ä¸‰éƒ¨åˆ†ï¼Œäº‘ä¸Šè¾¹å°±æ˜¯æˆ‘ä»¬çš„æ§åˆ¶é¢ï¼Œè¾¹å°±æ˜¯æˆ‘ä»¬çš„è¾¹ç¼˜èŠ‚ç‚¹ï¼Œ ç«¯å°±æ˜¯è·‘äº†æˆ‘ä»¬çš„ä¸€äº›ç«¯ä¾§è®¾å¤‡ï¼Œäº‘ä¸Šå·¦è¾¹æ˜¯ä¸€ä¸ªKubernetesçš„masterï¼Œæ˜¯æ²¡æœ‰åšè¿‡æ”¹åŠ¨çš„åŸç”Ÿçš„K8sæ§åˆ¶ï¼‰ï¼Œ åè¾¹KubeEdgeçš„ä¸€ä¸ªç»„ä»¶å«CloudCoreï¼Œäº‘ä¸Šçš„ç»„ä»¶ä¸»è¦æ˜¯ä¼šæ‹¿ä¸€äº›Kubernetesæ§åˆ¶é¢ä¸Šçš„ä¸œè¥¿ï¼Œ é€šè¿‡EdgeControllerå’ŒDeviceControlleråšä¸€äº›å¤„ç†ï¼Œç„¶åé€šè¿‡ä¸‹è¾¹çš„Cloud Hubï¼ŒCloud Hubä¸»è¦æ˜¯è·Ÿè¾¹ç«¯é€šä¿¡çš„ï¼Œ è¾¹ç«¯æœ‰ä¸ªEdgeHubå’ŒCloud Hubé€šä¿¡ï¼Œç„¶åæŠŠæ•°æ®æ‹¿ä¸‹æ¥ã€‚</p><p><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-33-55.webp" type="image/webp"><img src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-33-55.png" alt></picture></p><p>è¾¹ç«¯æ˜¯ä¸»è¦åšäº†ä¸€ä¸ªåº”ç”¨ç®¡ç†å’Œè®¾å¤‡ç®¡ç†çš„èƒ½åŠ›ï¼Œåº”ç”¨ç®¡ç†å·¦è¾¹ä¼šæœ‰ä¸€ä¸ªEdgedï¼Œ å³è¾¹æœ‰DeviceTwinã€EventBusï¼Œåˆ†åˆ«æ˜¯åº”ç”¨ç®¡ç†å’Œè®¾å¤‡ç®¡ç†ï¼Œå·¦è¾¹æœ‰ä¸ªDataStoreï¼Œå°±æ˜¯æˆ‘ä»¬è¯´çš„æœ¬åœ°è‡ªæ²»çš„èƒ½åŠ›ï¼Œ æ¯”å¦‚è¯´æˆ‘ä»¬è¿™åº”ç”¨æˆ–è€…è®¾å¤‡çš„å…ƒç´ ä»äº‘ä¸Šåˆ†å‘ä¸‹æ¥ï¼Œæˆ‘ä»¬æ˜¯å…ˆæŠŠå®ƒå­˜åˆ°ä¸€ä¸ªæ•°æ®åº“é‡Œï¼Œç„¶åå†åˆ°å®ƒçš„Edgedæˆ–è€…è®¾å¤‡é‡Œè¾¹ï¼Œ è¿™æ ·å°±èƒ½ä¿è¯äº‘è¾¹ç½‘ç»œæ–­å¼€æˆ–è€…è¾¹ç¼˜èŠ‚ç‚¹é‡å¯äº†ä»¥åæˆ‘åº”ç”¨çš„Edgedå®ƒå¯ä»¥ä»æ•°æ®åº“é‡ŒæŠŠåº”ç”¨æºæ•°æ®æ‹¿å‡ºæ¥ï¼Œ è¿™æ ·å°±èƒ½ä¿è¯åœ¨æ•…éšœçš„æƒ…å†µä¸‹ä¸šåŠ¡å¯ä»¥æ­£å¸¸æ¢å¤ã€‚</p><h3 id="å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½"><a href="#å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½"></a>å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½</h3><ol><li>äº‘è¾¹å¯é ååŒ<ul><li>åŒå‘å¤šè·¯æœç”¨æ¶ˆæ¯é€šé“ï¼Œæ”¯æŒè¾¹ç¼˜èŠ‚ç‚¹ä½äºç§æœ‰ç½‘ç»œ</li><li>Websocket + æ¶ˆæ¯å°è£…ï¼Œå¤§å¹…å‡å°‘é€šä¿¡å‹åŠ›ï¼Œé«˜å»¶æ—¶ä¸‹ä»å¯æ­£å¸¸å·¥ä½œ</li><li>äº‘è¾¹æ¶ˆæ¯æ ¡éªŒ</li></ul></li><li>è¾¹ç¼˜ç¦»çº¿è‡ªæ²»<ul><li>èŠ‚ç‚¹äº‘æ•°æ®æŒä¹…åŒ–ï¼Œå®ç°èŠ‚ç‚¹çº§ç¦»çº¿è‡ªæ²»</li><li>èŠ‚ç‚¹æ•…éšœæ¢å¤ï¼Œæ— éœ€List-watchï¼Œé™ä½ç½‘ç»œå‹åŠ›ï¼Œå¿«é€Ÿready</li></ul></li><li>è¾¹ç¼˜æè‡´è½»é‡<ul><li>é‡ç»„KubeletåŠŸèƒ½æ¨¡å—ï¼Œæè‡´è½»é‡åŒ–ï¼ˆï½70MBå†…å­˜å ç”¨ï¼‰</li><li>æ”¯æŒCRIé›†æˆï¼ŒContainerdã€CRI-Oï¼Œä¼˜åŒ–runtimeèµ„æºæ¶ˆè€—</li></ul></li><li>è¾¹ç¼˜è®¾å¤‡ç®¡ç†<ul><li>äº‘ç«¯é€šè¿‡kubernetes APIç®¡ç†è®¾å¤‡Device</li></ul></li></ol><h2 id="KubeEdge2-0-Roadmap"><a href="#KubeEdge2-0-Roadmap" class="headerlink" title="KubeEdge2.0 Roadmap"></a>KubeEdge2.0 Roadmap</h2><p>ä»¥ä¸‹æ˜¯å®˜æ–¹ç»™çš„2.0è®¡åˆ’æ”¯æŒçš„äº®ç‚¹åŠŸèƒ½:</p><ol><li>æ”¯æŒistioï¼›</li><li>æ”¯æŒFaaSï¼›</li><li>æ”¯æŒæ›´å¤šç±»å‹çš„è®¾å¤‡åè®®åˆ°è¾¹ç¼˜èŠ‚ç‚¹ï¼Œå¦‚AMQPï¼Œè“ç‰™ï¼ŒZigBeeç­‰ï¼›</li><li>æ”¯æŒåƒä¸ªè¾¹ç¼˜èŠ‚ç‚¹å’Œæ•°ç™¾ä¸‡ä¸ªè®¾å¤‡çš„è¶…å¤§è§„æ¨¡è¾¹ç¼˜é›†ç¾¤ï¼ˆkubernetesæ¨èå•é›†ç¾¤æœ€å¤§èŠ‚ç‚¹æ•°æ˜¯1000ï¼‰ï¼›</li><li>å®ç°æ•°åƒèŠ‚ç‚¹çš„åº”ç”¨æ™ºèƒ½è°ƒåº¦ï¼›</li></ol><h2 id="KubeEdgeçš„ä¸è¶³ä»¥åŠæˆ‘ä»¬éœ€è¦å»åšçš„å·¥ä½œ"><a href="#KubeEdgeçš„ä¸è¶³ä»¥åŠæˆ‘ä»¬éœ€è¦å»åšçš„å·¥ä½œ" class="headerlink" title="KubeEdgeçš„ä¸è¶³ä»¥åŠæˆ‘ä»¬éœ€è¦å»åšçš„å·¥ä½œ"></a>KubeEdgeçš„ä¸è¶³ä»¥åŠæˆ‘ä»¬éœ€è¦å»åšçš„å·¥ä½œ</h2><ol><li>ç›¸å…³ç»„ä»¶æ²¡æœ‰å®¹å™¨åŒ–ä»¥åŠç¼ºä¹é«˜å¯ç”¨æ€§æ–¹æ¡ˆ</li><li>é¡¹ç›®å¤„äºå‘å±•ä¸­æœŸï¼Œå¾ˆå¤šä¸œè¥¿å¤„äºä¸ç¨³å®šçŠ¶æ€</li><li>ç¤¾åŒºä¸æ˜¯ç‰¹åˆ«æ´»è·ƒï¼Œæ¯”å¦‚exampleç›®å‰æ— æ³•åœ¨1.4ç‰ˆæœ¬ä¸Šæ­£å¸¸è¿è¡Œ</li><li>å®‰è£…å·¥å…·keadmæ²¡æœ‰æ”¯æŒç¦»çº¿å®‰è£…ï¼Œä¸”æœ‰ä¸€äº›ç¼ºé™·</li><li>æ²¡æœ‰å…·ä½“æ€§èƒ½æµ‹è¯•æ•°æ®æ”¯æ’‘</li></ol><h2 id="ç›®å‰æˆ‘ä»¬åšçš„"><a href="#ç›®å‰æˆ‘ä»¬åšçš„" class="headerlink" title="ç›®å‰æˆ‘ä»¬åšçš„"></a>ç›®å‰æˆ‘ä»¬åšçš„</h2><ol><li>åŸºäºå…¬å¸PaaSäº§å“æä¾›å®Œæ•´çš„äº‘ç«¯ç”¨æˆ·ä½“éªŒåŒ…æ‹¬ç»Ÿä¸€å†…ç½®é•œåƒä»“ï¼Œç®¡ç†ç•Œé¢ç­‰ï¼›</li><li>è‡ªå®šä¹‰EdgeAppControllerï¼Œä»¥æ»¡è¶³è¾¹ç¼˜åœºæ™¯ä¸‹åº”ç”¨ä¸‹å‘çš„éœ€æ±‚ï¼›</li><li>å®Œæ•´çš„ç›‘æ§å‘Šè­¦æ”¯æŒï¼Œä»¥åŠè‡ªå®šä¹‰æŒ‡æ ‡çš„å¼€å‘ï¼ˆExporterçš„æ”¹é€ ï¼‰ï¼›</li><li>ç®¡ç†å‘˜å‹å¥½çš„Dashboardï¼ŒåŒ…æ‹¬æ›´å‹å¥½çš„åº”ç”¨éƒ¨ç½²ï¼ŒèŠ‚ç‚¹æ¥å…¥ç­‰åŠŸèƒ½ï¼›</li><li>ä¸€äº›ç¨³å®šæ€§æ”¹é€ ï¼ˆäº‘ç«¯ç»„ä»¶cloudcoreçš„serviceåŒ–ï¼‰ï¼›</li><li>KubeEdgeçš„å®šåˆ¶åŒ–ï¼Œç”¨äºåˆå¹¶ä¸€äº›æ— æ³•ç¬¬ä¸€æ—¶é—´è¢«ç¤¾åŒºåˆå¹¶Releaseçš„æœ‰ä»·å€¼çš„åŠŸèƒ½åˆ†æ”¯ï¼Œå®šåˆ¶åŒ–æˆ‘ä»¬çš„åŠŸèƒ½ï¼›</li></ol><h2 id="kubeedgeé€šä¿¡åŸç†"><a href="#kubeedgeé€šä¿¡åŸç†" class="headerlink" title="kubeedgeé€šä¿¡åŸç†"></a>kubeedgeé€šä¿¡åŸç†</h2><p>æˆ‘ä»¬æ˜¯å¦èƒ½åƒç®¡ç†æ™®é€šèŠ‚ç‚¹ä¸€æ ·ç®¡ç†è¾¹ç¼˜èŠ‚ç‚¹å‘¢ï¼Ÿæ¯”å¦‚è¯´æŸ¥çœ‹æŸä¸ªå®¹å™¨çš„è°ƒè¯•æ—¥å¿—ï¼Œèµ„æºç”¨é‡ï¼Œ<em>Exec</em>åˆ°æŸä¸ªå®¹å™¨ä¸­è¿›è¡Œè°ƒè¯•ï¼Œ é€šè¿‡Prometheusç›‘æ§èŠ‚ç‚¹å’Œåº”ç”¨ç­‰ç­‰ï¼Œè¿™äº›åŠŸèƒ½å¯¹äºæ— è®ºæ˜¯PaaSè¿˜æ˜¯è¾¹ç¼˜è®¡ç®—å¹³å°éƒ½éå¸¸é‡è¦ğŸ’°ã€‚KubeEdgeè¾ƒæ—©ç‰ˆæœ¬æ²¡æœ‰ç»™å‡ºè§£å†³æ–¹æ¡ˆï¼Œ ä¹Ÿå°±æ˜¯è¯´è¿™äº›åŠŸèƒ½æ— æ³•ä»KubeEdgeå¼€ç®±ç›´æ¥è·å–ï¼Œå®ç°ä»¥ä¸ŠåŠŸèƒ½æœ€å¤§çš„éšœç¢å°±æ˜¯ç½‘ç»œé—®é¢˜ğŸŒã€‚</p><p>ç›®å‰é’ˆå¯¹è¿™äº›åŠŸèƒ½ï¼Œè¾ƒæ–°ç‰ˆæœ¬KubeEdgeå·²ç»ç»™å‡ºå¯¹åº”çš„è§£å†³æ–¹æ¡ˆï¼Œå³é€šè¿‡<em>éš§é“Tunnel+è‡ªå®šä¹‰æ¶ˆæ¯</em>å®ç°ï¼Œä¸»è¦å¯¹åº”çš„æ¨¡å—æ˜¯CloudStreamå’ŒEdgeStreamã€‚ å½“æˆ‘ä»¬éœ€è¦è¿™äº›åŠŸèƒ½æ—¶ï¼Œå¿…é¡»å¼€å¯è¿™ä¸¤ä¸ªæ¨¡å—ï¼ŒåŒæ—¶è¿›è¡Œé…ç½®ï¼Œå…·ä½“é…ç½®å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œä»¥ä¸‹è¿™ä¸¤ä¸ªæ¨¡å—çš„é€šä¿¡ç¤ºæ„å›¾ã€‚</p><p><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-40-04.webp" type="image/webp"><img src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-40-04.png" alt></picture></p><p>è¿™é‡Œæˆ‘ä»¥PrometheusæŠ“å–EdgeèŠ‚ç‚¹å®¹å™¨è¿è¡Œæ—¶æŒ‡æ ‡æ•°æ®ä¸ºä¾‹ï¼Œå¸®å¤§å®¶å¤§è‡´æ¢³ç†æµç¨‹ä»¥åŠä¸»è¦å‡½æ•°ã€‚</p><blockquote><p>åœ¨æ™®é€škubernetesé›†ç¾¤ä¸­å¯ä»¥é€šè¿‡å®‰è£…cadvisorè·å–å®¹å™¨è¿è¡Œæ—¶çš„ä¸€äº›æŒ‡æ ‡æ•°æ®ï¼Œ KubeEdgeå—é™äºèµ„æºçš„é™åˆ¶ï¼Œæ— æ³•åœ¨è¾¹ç¼˜èŠ‚ç‚¹å®‰è£…cadvisorç»„ä»¶ï¼Œç›®å‰Edgedå·²å®ç°äº†cadvisorçš„æŒ‡æ ‡å®šä¹‰ã€‚</p></blockquote><p>ç°åœ¨ï¼Œprometheusè¦æŠ“å–edge1(10.31.100.4)ä¸Šedgedæ‰€å®šä¹‰çš„æŒ‡æ ‡æ—¶ï¼Œè¯·æ±‚10.31.100.4:10350/metrics/cadvisorï¼Œ ç”±äºæˆ‘ä»¬é…ç½®iptables natè¡¨çš„OUTPUT,æ‰€æœ‰target portä¸º10350æŠ¥æ–‡éƒ½ä¼šè¢«è½¬å‘åˆ°æœ¬æœºçš„10003çš„ç«¯å£ï¼Œ ç”±äºTCPåè®®æ ˆå¤„äºå†…æ ¸ï¼Œåœ¨åº”ç”¨å±‚æ”¶åˆ°è¯·æ±‚çš„Source IPå’ŒPortä¸ä¼šæ”¹å˜ï¼Œè‡³æ­¤è¯¥è¯·æ±‚å°†ä¼šæœ‰CloudStreamå†…ç½®çš„Http Serverå¤„ç†ï¼Œ è¿™ä¸ªHttpæœåŠ¡é»˜è®¤ç«¯å£ä¸º10003ï¼Œå®ƒçš„ä¸»è¦åŠŸèƒ½å°±æ˜¯å¤„ç†è¢«æ‹¦æˆªçš„å„ç§æµé‡ï¼Œç›®å‰åŒ…æ‹¬Logã€Metricsã€èŠ‚ç‚¹ç»Ÿè®¡ç­‰æµé‡ã€‚</p><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *StreamServer)</span> <span class="title">installDebugHandler</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ws := <span class="built_in">new</span>(restful.WebService)</span><br><span class="line">	ws.Path(<span class="string">&quot;/containerLogs&quot;</span>)</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getContainerLogs))</span><br><span class="line">	s.container.Add(ws)</span><br><span class="line">	ws = <span class="built_in">new</span>(restful.WebService)</span><br><span class="line">	ws.Path(<span class="string">&quot;/exec&quot;</span>)</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getExec))</span><br><span class="line">	ws.Route(ws.POST(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getExec))</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;uid&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getExec))</span><br><span class="line">	ws.Route(ws.POST(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;uid&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getExec))</span><br><span class="line">	s.container.Add(ws)</span><br><span class="line">	ws = <span class="built_in">new</span>(restful.WebService)</span><br><span class="line">	ws.Path(<span class="string">&quot;/stats&quot;</span>)</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;&quot;</span>).</span><br><span class="line">		To(s.getMetrics))</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;/summary&quot;</span>).</span><br><span class="line">		To(s.getMetrics))</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;/container&quot;</span>).</span><br><span class="line">		To(s.getMetrics))</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;/&#123;podName&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getMetrics))</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;/&#123;namespace&#125;/&#123;podName&#125;/&#123;uid&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getMetrics))</span><br><span class="line">	s.container.Add(ws)</span><br><span class="line">	<span class="comment">// metrics api is widely used for Promethus</span></span><br><span class="line">	ws = <span class="built_in">new</span>(restful.WebService)</span><br><span class="line">	ws.Path(<span class="string">&quot;/metrics&quot;</span>)</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;&quot;</span>).</span><br><span class="line">		To(s.getMetrics))</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;/cadvisor&quot;</span>).</span><br><span class="line">		To(s.getMetrics))</span><br><span class="line">	s.container.Add(ws)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æŒ‡æ ‡å¯¹åº”å¤„ç†è¯·æ±‚å‡½æ•°ä¸º<code>getMetrics</code>ï¼Œä¸»è¦è¿‡ç¨‹æ˜¯æ ¹æ®<code>r.Request.Host</code>æ‰¾åˆ°å¯¹åº”Sessionï¼ˆcloudstreamç»´æŠ¤äº†åˆ°æ¯ä¸ªedgeèŠ‚ç‚¹çš„sessionæ± ï¼ŒKeyå³edgeçš„Internal Ipï¼Œ æ¯ä¸ªsessionè´Ÿè´£å‘Tunnelå‘é€å’Œè¯»å–Message)ï¼Œåˆ›å»ºæ–°çš„å¤„ç†çš„åç¨‹ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ä»»åŠ¡æ± <code>Session.apiServerConn</code>ä¸­ï¼Œå¤„ç†åç¨‹ä¸­å°†çœŸå®çš„è¯·æ±‚æ•°æ®ï¼ˆåŸè¯·æ±‚ï¼‰<code>ç¼–ç </code>ä¸ºMessageï¼Œ å¹¶é€šè¿‡é€šé“å‘é€edgenode1çš„edgestreamè¿›è¡Œå¤„ç†ã€‚</p><p><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-42-51.webp" type="image/webp"><img src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubeedge-day-01/2020-10-27-14-42-51.png" alt></picture></p><p>ğŸ§æ­¤æ—¶ï¼Œè¯·æ±‚å·²ç»è¢«å‘é€åˆ°edgenode1ä¸Šï¼Œä¸”è¢«edgestreamçš„è½®è¯¢ç›‘å¬å‡½æ•°æ”¶åˆ°ï¼Œedgestreamä¼šé€šè¿‡å‡½æ•°<code>ReadMessageFromTunnel</code>å¯¹æ¶ˆæ¯è¿›è¡Œè§£ç ï¼Œ åˆ¤æ–­æ¶ˆæ¯çš„ç±»å‹ï¼Œè¿™é‡Œæ˜¾ç„¶æ˜¯ä¸€ä¸ª<em>Metricsç±»å‹</em>çš„æ¶ˆæ¯ã€‚</p><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ReadMessageFromTunnel</span><span class="params">(r io.Reader)</span> <span class="params">(*Message, error)</span></span> &#123;</span><br><span class="line">	buf := bufio.NewReader(r)</span><br><span class="line">	connectID, err := binary.ReadUvarint(buf)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	messageType, err := binary.ReadUvarint(buf)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	data, err := ioutil.ReadAll(buf)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	klog.Infof(<span class="string">&quot;Receive Tunnel message Connectid %d messageType %s data:%v string:[%v]&quot;</span>,</span><br><span class="line">		connectID, MessageType(messageType), data, <span class="keyword">string</span>(data))</span><br><span class="line">	<span class="keyword">return</span> &amp;Message&#123;</span><br><span class="line">		ConnectID:   connectID,</span><br><span class="line">		MessageType: MessageType(messageType),</span><br><span class="line">		Data:        data,</span><br><span class="line">	&#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯åˆæ³•çš„æ¶ˆæ¯ï¼Œedgestreamåˆ›å»ºæ–°çš„åç¨‹è¿›è¡Œå¤„ç†ï¼Œå¹¶æŠŠè¿™äº›å¤„ç†åç¨‹æ·»åŠ ç»Ÿä¸€çš„ä»»åŠ¡æ± ä¸­ï¼Œè¿™é‡ŒMetricsç±»å‹çš„å¤„ç†è¿‡ç¨‹ä¸ºï¼Œ å°†Messageè¿›è¡Œ<code>è§£ç </code>å¾—åˆ°åŸå§‹è¯·æ±‚æ•°æ®ï¼Œå¹¶å‘èµ·çœŸå®è¯·æ±‚ï¼ˆè¿™æ—¶å·²ç»æˆåŠŸç©¿é€åˆ°å†…ç½‘å•¦ï¼‰ï¼Œå¹¶å°†Metricsæ•°æ®åœ¨ç¼–ç æˆMessageé€šè¿‡é€šé“å‘é€åˆ°cloudstreamä¸­ã€‚</p><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¶ˆæ¯è§£ç </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *TunnelSession)</span> <span class="title">serveMetricsConnection</span><span class="params">(m *stream.Message)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">	metricsCon := &amp;stream.EdgedMetricsConnection&#123;</span><br><span class="line">		ReadChan: <span class="built_in">make</span>(<span class="keyword">chan</span> *stream.Message, <span class="number">128</span>),</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> err := json.Unmarshal(m.Data, metricsCon); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		klog.Errorf(<span class="string">&quot;unmarshal connector data error %v&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span> err</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	s.AddLocalConnection(m.ConnectID, metricsCon)</span><br><span class="line">	<span class="keyword">return</span> metricsCon.Serve(s.Tunnel)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å‘é€çœŸå®è¯·æ±‚</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ms *EdgedMetricsConnection)</span> <span class="title">Serve</span><span class="params">(tunnel SafeWriteTunneler)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">	client := http.Client&#123;&#125;</span><br><span class="line">	req, err := http.NewRequest(<span class="string">&quot;GET&quot;</span>, ms.URL.String(), <span class="literal">nil</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		klog.Errorf(<span class="string">&quot;create new metrics request error %v&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span> err</span><br><span class="line">	&#125;</span><br><span class="line">	req.Header = ms.Header</span><br><span class="line">	<span class="comment">// ç›®å‰é€šé“åªæ”¯æŒText messageï¼Œè¿™é‡Œè§£å†³äº†PrometheusæŠ“å–å¤±è´¥çš„é—®é¢˜</span></span><br><span class="line">	req.Header.Set(<span class="string">&quot;accept-encoding&quot;</span>, <span class="string">&quot;identity&quot;</span>)</span><br><span class="line">	resp, err := client.Do(req)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		klog.Errorf(<span class="string">&quot;request metrics error %v&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span> err</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line">	scan := bufio.NewScanner(resp.Body)</span><br><span class="line">	stop := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">for</span> mess := <span class="keyword">range</span> ms.ReadChan &#123;</span><br><span class="line">			<span class="keyword">if</span> mess.MessageType == MessageTypeRemoveConnect &#123;</span><br><span class="line">				klog.Infof(<span class="string">&quot;receive remove client id %v&quot;</span>, mess.ConnectID)</span><br><span class="line">				<span class="built_in">close</span>(stop)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">for</span> retry := <span class="number">0</span>; retry &lt; <span class="number">3</span>; retry++ &#123;</span><br><span class="line">			msg := NewMessage(ms.MessID, MessageTypeRemoveConnect, <span class="literal">nil</span>)</span><br><span class="line">			<span class="keyword">if</span> err := msg.WriteTo(tunnel); err != <span class="literal">nil</span> &#123;</span><br><span class="line">				klog.Errorf(<span class="string">&quot;%v send %s message error %v&quot;</span>, ms, msg.MessageType, err)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> scan.Scan() &#123;</span><br><span class="line">		<span class="keyword">select</span> &#123;</span><br><span class="line">		<span class="keyword">case</span> &lt;-stop:</span><br><span class="line">			klog.Infof(<span class="string">&quot;receive stop single, so stop metrics scan ...&quot;</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 10 = \n</span></span><br><span class="line">		msg := NewMessage(ms.MessID, MessageTypeData, <span class="built_in">append</span>(scan.Bytes(), <span class="number">10</span>))</span><br><span class="line">		err := msg.WriteTo(tunnel)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			klog.Errorf(<span class="string">&quot;write tunnel message %v error&quot;</span>, msg)</span><br><span class="line">			<span class="keyword">return</span> err</span><br><span class="line">		&#125;</span><br><span class="line">		klog.Infof(<span class="string">&quot;%v write metrics data %v&quot;</span>, ms.String(), <span class="keyword">string</span>(scan.Bytes()))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœ€åä¸€æ­¥ï¼Œç»ˆäºè¦ç»“æŸå•¦ğŸ˜…ï¼cloudstreamä¼šè¯»å–Messageï¼Œè§£ç å¾—åˆ°ç”¨æˆ·éœ€è¦çš„æŒ‡æ ‡æ•°æ®ï¼Œå¹¶å“åº”è¯·æ±‚ã€‚</p><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Session)</span> <span class="title">Serve</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">defer</span> s.Close()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		t, r, err := s.tunnel.NextReader()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			klog.Errorf(<span class="string">&quot;get %v reader error %v&quot;</span>, s, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> t != websocket.TextMessage &#123;</span><br><span class="line">			klog.Errorf(<span class="string">&quot;Websocket message type must be %v type&quot;</span>, websocket.TextMessage)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		message, err := stream.ReadMessageFromTunnel(r)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			klog.Errorf(<span class="string">&quot;Read message from tunnel %v error %v&quot;</span>, s.String(), err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> err := s.ProxyTunnelMessageToApiserver(message); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			klog.Errorf(<span class="string">&quot;Proxy tunnel message [%s] to kube-apiserver error %v&quot;</span>, message.String(), err)</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ€è€ƒä¸€ä¸‹é€šè¿‡æ‹¦æˆªæµé‡å®ç°ç©¿é€æœ‰ä»€ä¹ˆå¼Šç«¯ï¼Ÿ</p></blockquote><h2 id="è®²è®²è·³è¿‡çš„å‘"><a href="#è®²è®²è·³è¿‡çš„å‘" class="headerlink" title="è®²è®²è·³è¿‡çš„å‘"></a>è®²è®²è·³è¿‡çš„å‘</h2><p>è®²è®²æˆ‘åœ¨éªŒè¯å’Œå­¦ä¹ kubeedgeç½‘ç»œè®¾è®¡æ—¶çš„æ•…äº‹ï¼ˆå‘çˆ¹è¿‡ç¨‹ï¼‰ï¼š</p><ol><li>Kubernetesçš„Nodeçš„<code>Status.daemonEndpoints.KubeletEndpoint.Port</code>ä½ çŸ¥é“å—ï¼Ÿ å…¶å®å½“æˆ‘ä»¬<code>kubectl exec</code>æ—¶ï¼Œæœ€ç»ˆå‘èµ·å‘kubeletè¯·æ±‚ï¼Œkubeletçš„ç«¯å£å°±æ˜¯ç”±è¯¥å­—æ®µç¡®å®šã€‚</li><li>calicoå¤æ‚çš„iptablesè§„åˆ™ï¼Œè®©å®¹å™¨çš„æµé‡å˜å¾—ååˆ†æ€ªå¼‚ï¼Œæœ€ç»ˆåªèƒ½ä½¿ç”¨hostNetworkæ¨¡å¼å•¦ğŸ¤¬</li><li>ä½ çŸ¥é“prometheusæŠ“å–ç«¯å£æ—¶ï¼Œä¼šè‡ªåŠ¨åŠ ä¸Šè¯·æ±‚å¤´<code>Accept-Encoding: gzip</code>ï¼Œå¹¶ä¸”kubeedge tunnelç›®å‰ä¸æ”¯æŒBinary Messageå—ï¼Ÿ</li><li>å›½å®¶ç»Ÿè®¡å±€ç›¸å…³ç»Ÿè®¡æ•°æ®è¡¨æ˜ï¼Œé‚£ä¸¤å¤©æˆ‘æ•²çš„curlå‘½ä»¤å¯ç»•åœ°çƒä¸¤åœˆï¼Œprometheusçš„é‡è£…æ¬¡æ•°é«˜è¾¾ç™¾ä¸‡æ¬¡ï¼ğŸ‘Š</li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>KubeEdgeæœ‰éå¸¸è‰¯å¥½çš„å‰æ™¯ï¼Œè¿™ä¸»è¦å¾—åŠ›äº<code>äº‘è¾¹ååŒ</code>çš„æ€æƒ³ï¼Œè™½ç„¶ç›®å‰å¼€æºçš„KubeEdgeæ•´ä½“çš„æ–¹æ¡ˆè¿˜ä¸å®Œå–„ï¼Œä½†æ˜¯ï¼Œ éšç€ç”¨æˆ·çš„å¢å¤šå’Œç¤¾åŒºçš„å‘å±•ï¼ŒKubeEdgeå°†ä¼šè¶Šæ¥è¶Šæˆç†Ÿï¼Œå¯¹äºæƒ³è¦åŠ å…¥KubeEdgeç¤¾åŒºçš„æœ‹å‹ï¼Œç›®å‰ä¹Ÿæ˜¯æœ€ä½³æ—¶æœºã€‚ åŒæ—¶ï¼Œæˆ‘ä»¬åŸºäºKubeEdgeæ‰€åšçš„äº§å“åŒ–å·¥ä½œç›®å‰è¿˜å¤„äºåˆçº§é˜¶æ®µï¼Œä½†æ˜¯æœ‰äº†Kubernetesçš„äº§å“åŒ–æ”¹é€ çš„ç»éªŒï¼Œç›¸å…³å·¥ä½œä¹Ÿåœ¨æœ‰æ¡ä¸ç´Šçš„è¿›è¡Œã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>é™¤äº†å®˜æ–¹ä»“åº“å’Œæ–‡æ¡£ï¼Œä»¥ä¸‹èµ„æ–™ä¹Ÿååˆ†æœ‰ä»·å€¼ã€‚</p><ol><li><a target="_blank" rel="noopener" href="https://kccncna19.sched.com/event/Uahz">KubeEdge-Kubernetes Native Edge Computing Frameworkï¼ˆ2019-kubeconï¼‰</a></li><li><a target="_blank" rel="noopener" href="https://kccncna19.sched.com/event/Uafu">KubeEdge Deep Dive(2019-kubecon)</a></li><li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/LS5QnDwVIMVLTuB_yvdjoA">kubeEdgeæ¶æ„è§£è¯»</a></li><li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1LJ411D7t1">åä¸ºäº‘è¯¾å ‚-KubeEdgeå®æˆ˜å®å…¸</a></li><li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/32553477">QUIC-Quick UDP Internet Connection</a>ä¸‹</li></ol></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…:</span> <span class="post-copyright-info"><a href="mailto:undefined">Holder</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥:</span> <span class="post-copyright-info"><a href="https://blog.happyhack.io/2020/10/27/kubeedge-day-01/">https://blog.happyhack.io/2020/10/27/kubeedge-day-01/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜:</span> <span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://blog.happyhack.io" target="_blank">Happy Hack Everday</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/kubeedge/">kubeedge</a><a class="post-meta__tags" href="/tags/%E8%BE%B9%E7%BC%98%E8%AE%A1%E7%AE%97/">è¾¹ç¼˜è®¡ç®—</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/donggangcj/CDN@master/image/kubeedge-day-01/2020-10-27-17-52-03.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/10/30/kubernetes-develop-tips/"><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubernetes-develop-tips/2020-10-29-17-40-18.webp" type="image/webp"><img class="prev-cover" data-lazy-src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubernetes-develop-tips/2020-10-29-17-40-18.png" onerror='onerror=null,src="/img/404.jpg"'></picture><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">kuberneteså¹³å°å¼€å‘è€…å°æŠ€å·§</div></div></a></div><div class="next-post pull-right"><a href="/2020/10/12/kubernetes-crd-day1/"><picture><source srcset="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubernetes-crd-day1/2020-10-12-14-01-00.webp" type="image/webp"><img class="next-cover" data-lazy-src="https://cdn.jsdelivr.net/gh/donggangcj/CDN/image/kubernetes-crd-day1/2020-10-12-14-01-00.png" onerror='onerror=null,src="/img/404.jpg"'></picture><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">ä½¿ç”¨kubebuilderå¼€å‘ç®€å•çš„Operator</div></div></a></div></nav></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Holder</div><div class="framework-info"><span>æ¡†æ¶</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49b1f5">hexo-generator-search</a> <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module" defer="defer"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script id="click-show-text" src="/js/third-party/ClickShowText.js" async="async" mobile="false"></script></div></body></html>